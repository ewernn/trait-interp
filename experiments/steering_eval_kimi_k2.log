
Evaluating 4 traits with shared model
Loading model: moonshotai/Kimi-K2-Thinking...
You are using a model of type kimi_k2 to instantiate a model of type deepseek_v3. This is not supported for all configurations of models and can yield errors.
  Skipping compressed_tensors compress_model + fast init (already compressed on disk)
You are using a model of type kimi_k2 to instantiate a model of type deepseek_v3. This is not supported for all configurations of models and can yield errors.
  Pipeline parallel: 61 layers across 8 GPUs (7+1 x 5, 7 x 3)
You are using a model of type kimi_k2 to instantiate a model of type deepseek_v3. This is not supported for all configurations of models and can yield errors.
`torch_dtype` is deprecated! Use `dtype` instead!
Loading checkpoint shards:   0%|          | 0/62 [00:00<?, ?it/s]Loading checkpoint shards:   2%|▏         | 1/62 [00:00<00:25,  2.43it/s]Loading checkpoint shards:   3%|▎         | 2/62 [00:04<02:25,  2.42s/it]Loading checkpoint shards:   5%|▍         | 3/62 [00:08<03:02,  3.09s/it]Loading checkpoint shards:   6%|▋         | 4/62 [00:12<03:18,  3.42s/it]Loading checkpoint shards:   8%|▊         | 5/62 [00:15<03:24,  3.58s/it]Loading checkpoint shards:  10%|▉         | 6/62 [00:20<03:44,  4.01s/it]Loading checkpoint shards:  11%|█▏        | 7/62 [00:27<04:23,  4.78s/it]Loading checkpoint shards:  13%|█▎        | 8/62 [00:33<04:47,  5.31s/it]Loading checkpoint shards:  15%|█▍        | 9/62 [00:39<04:45,  5.39s/it]Loading checkpoint shards:  16%|█▌        | 10/62 [00:45<04:58,  5.74s/it]Loading checkpoint shards:  18%|█▊        | 11/62 [00:53<05:18,  6.24s/it]Loading checkpoint shards:  19%|█▉        | 12/62 [00:58<04:56,  5.94s/it]Loading checkpoint shards:  21%|██        | 13/62 [01:02<04:18,  5.28s/it]Loading checkpoint shards:  23%|██▎       | 14/62 [01:06<03:57,  4.94s/it]Loading checkpoint shards:  24%|██▍       | 15/62 [01:11<03:52,  4.96s/it]Loading checkpoint shards:  26%|██▌       | 16/62 [01:15<03:38,  4.76s/it]Loading checkpoint shards:  27%|██▋       | 17/62 [01:19<03:22,  4.50s/it]Loading checkpoint shards:  29%|██▉       | 18/62 [01:23<03:09,  4.31s/it]Loading checkpoint shards:  31%|███       | 19/62 [01:28<03:19,  4.64s/it]Loading checkpoint shards:  32%|███▏      | 20/62 [01:34<03:26,  4.91s/it]Loading checkpoint shards:  34%|███▍      | 21/62 [01:41<03:51,  5.64s/it]Loading checkpoint shards:  35%|███▌      | 22/62 [01:48<03:59,  5.99s/it]Loading checkpoint shards:  37%|███▋      | 23/62 [01:54<03:57,  6.10s/it]Loading checkpoint shards:  39%|███▊      | 24/62 [02:02<04:14,  6.70s/it]Loading checkpoint shards:  40%|████      | 25/62 [02:07<03:42,  6.01s/it]Loading checkpoint shards:  42%|████▏     | 26/62 [02:12<03:30,  5.86s/it]Loading checkpoint shards:  44%|████▎     | 27/62 [02:18<03:23,  5.82s/it]Loading checkpoint shards:  45%|████▌     | 28/62 [02:22<03:04,  5.42s/it]Loading checkpoint shards:  47%|████▋     | 29/62 [02:28<02:59,  5.45s/it]Loading checkpoint shards:  48%|████▊     | 30/62 [02:34<02:59,  5.62s/it]Loading checkpoint shards:  50%|█████     | 31/62 [02:43<03:22,  6.54s/it]Loading checkpoint shards:  52%|█████▏    | 32/62 [02:51<03:36,  7.23s/it]Loading checkpoint shards:  53%|█████▎    | 33/62 [02:59<03:29,  7.21s/it]Loading checkpoint shards:  55%|█████▍    | 34/62 [03:05<03:18,  7.07s/it]Loading checkpoint shards:  56%|█████▋    | 35/62 [03:09<02:43,  6.06s/it]Loading checkpoint shards:  58%|█████▊    | 36/62 [03:13<02:21,  5.44s/it]Loading checkpoint shards:  60%|█████▉    | 37/62 [03:17<02:07,  5.10s/it]Loading checkpoint shards:  61%|██████▏   | 38/62 [03:23<02:04,  5.18s/it]Loading checkpoint shards:  63%|██████▎   | 39/62 [03:29<02:08,  5.61s/it]Loading checkpoint shards:  65%|██████▍   | 40/62 [03:37<02:16,  6.20s/it]Loading checkpoint shards:  66%|██████▌   | 41/62 [03:43<02:07,  6.06s/it]Loading checkpoint shards:  68%|██████▊   | 42/62 [03:48<01:55,  5.77s/it]Loading checkpoint shards:  69%|██████▉   | 43/62 [03:54<01:52,  5.92s/it]Loading checkpoint shards:  71%|███████   | 44/62 [04:00<01:44,  5.82s/it]Loading checkpoint shards:  73%|███████▎  | 45/62 [04:07<01:45,  6.18s/it]Loading checkpoint shards:  74%|███████▍  | 46/62 [04:18<02:02,  7.65s/it]Loading checkpoint shards:  76%|███████▌  | 47/62 [04:27<02:03,  8.21s/it]Loading checkpoint shards:  77%|███████▋  | 48/62 [04:34<01:46,  7.64s/it]Loading checkpoint shards:  79%|███████▉  | 49/62 [04:39<01:29,  6.89s/it]Loading checkpoint shards:  81%|████████  | 50/62 [04:45<01:20,  6.71s/it]Loading checkpoint shards:  82%|████████▏ | 51/62 [04:51<01:11,  6.48s/it]Loading checkpoint shards:  84%|████████▍ | 52/62 [05:02<01:19,  7.96s/it]Loading checkpoint shards:  85%|████████▌ | 53/62 [05:15<01:23,  9.24s/it]Loading checkpoint shards:  87%|████████▋ | 54/62 [05:24<01:13,  9.22s/it]Loading checkpoint shards:  89%|████████▊ | 55/62 [05:31<01:00,  8.67s/it]Loading checkpoint shards:  90%|█████████ | 56/62 [05:39<00:50,  8.42s/it]Loading checkpoint shards:  92%|█████████▏| 57/62 [05:46<00:40,  8.08s/it]Loading checkpoint shards:  94%|█████████▎| 58/62 [05:53<00:31,  7.79s/it]Loading checkpoint shards:  95%|█████████▌| 59/62 [05:59<00:21,  7.11s/it]Loading checkpoint shards:  97%|█████████▋| 60/62 [06:09<00:15,  7.99s/it]Loading checkpoint shards:  98%|█████████▊| 61/62 [06:18<00:08,  8.22s/it]Loading checkpoint shards: 100%|██████████| 62/62 [06:19<00:00,  6.03s/it]Loading checkpoint shards: 100%|██████████| 62/62 [06:19<00:00,  6.11s/it]
  from_pretrained: 1413s
  Fusing MoE: 60 layers × 384 experts...
    [1/60] fused (0s)    [2/60] fused (0s)    [3/60] fused (0s)    [4/60] fused (0s)    [5/60] fused (0s)    [6/60] fused (0s)    [7/60] fused (1s)    [8/60] fused (1s)    [9/60] fused (2s)    [10/60] fused (2s)    [11/60] fused (2s)    [12/60] fused (2s)    [13/60] fused (2s)    [14/60] fused (2s)    [15/60] fused (3s)    [16/60] fused (3s)    [17/60] fused (3s)    [18/60] fused (3s)    [19/60] fused (3s)    [20/60] fused (3s)    [21/60] fused (4s)    [22/60] fused (4s)    [23/60] fused (5s)    [24/60] fused (5s)    [25/60] fused (5s)    [26/60] fused (5s)    [27/60] fused (5s)    [28/60] fused (5s)    [29/60] fused (5s)    [30/60] fused (5s)    [31/60] fused (6s)    [32/60] fused (6s)    [33/60] fused (7s)    [34/60] fused (7s)    [35/60] fused (7s)    [36/60] fused (7s)    [37/60] fused (7s)    [38/60] fused (7s)    [39/60] fused (7s)    [40/60] fused (7s)    [41/60] fused (8s)    [42/60] fused (8s)    [43/60] fused (8s)    [44/60] fused (9s)    [45/60] fused (9s)    [46/60] fused (9s)    [47/60] fused (10s)    [48/60] fused (10s)    [49/60] fused (11s)    [50/60] fused (11s)    [51/60] fused (11s)    [52/60] fused (11s)    [53/60] fused (12s)    [54/60] fused (12s)    [55/60] fused (13s)    [56/60] fused (13s)    [57/60] fused (13s)    [58/60] fused (13s)    [59/60] fused (14s)    [60/60] fused (14s)
  Fused MoE: 60 layers in 14s, grouped_mm replaces 384-expert loop (patched DeepseekV3MoE.moe_infer)
Model loaded.
Traceback (most recent call last):
  File "/home/dev/trait-interp/analysis/steering/evaluate.py", line 1437, in <module>
    main()
  File "/home/dev/trait-interp/analysis/steering/evaluate.py", line 1148, in main
    asyncio.run(_run_main(
  File "/.uv/python_install/cpython-3.11.14-linux-x86_64-gnu/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "/.uv/python_install/cpython-3.11.14-linux-x86_64-gnu/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/.uv/python_install/cpython-3.11.14-linux-x86_64-gnu/lib/python3.11/asyncio/base_events.py", line 654, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/dev/trait-interp/analysis/steering/evaluate.py", line 1192, in _run_main
    judge = TraitJudge() if is_rank_zero() else None
            ^^^^^^^^^^^^
  File "/home/dev/trait-interp/utils/judge.py", line 153, in __init__
    raise ValueError("OPENAI_API_KEY environment variable not set")
ValueError: OPENAI_API_KEY environment variable not set
